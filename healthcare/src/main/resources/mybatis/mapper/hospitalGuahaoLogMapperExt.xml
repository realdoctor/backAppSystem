<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kanglian.healthcare.back.dal.dao.HospitalGuahaoLogDao">
	<!-- 获取挂号单列表 -->
	<select id="getGuahaoLog" resultMap="BaseResultMap"
		parameterType="com.kanglian.healthcare.back.dal.dao.HospitalGuahaoLogDao">
		select
		<include refid="columns" />
		from hospital_guahao_log t
		where t.hospital_id=#{hospitalId,jdbcType=VARCHAR} AND
		t.dept_id=#{deptId,jdbcType=VARCHAR} AND
		t.doctor_code=#{doctorCode,jdbcType=VARCHAR}
	</select>
	
	<!-- 我的预约 -->
	<select id="myGuahaoOrder" resultType="map" parameterType="string">
		SELECT
			t1.hospital_name AS hospitalName,
			t1.dept_name AS deptName,
			t1.hospital_level AS hospitalLevel,
			t2.doctor_name AS doctorName,
			t2.positional AS positional,
			t2.doctor_intro AS doctorIntro,
			t2.field AS goodAt,
			t.order_day AS orderDay,
			t3.plan AS plan,
			t4.receive_num AS receiveNum
		FROM
			hospital_guahao_log t
		LEFT JOIN hospital_dept t1 ON (
			t.hospital_id = t1.hospital_id
			AND t.dept_id = t1.dept_id
		)
		LEFT JOIN hospital_register_doctor t2 ON t.dept_id = t2.dept_id
		LEFT JOIN hospital_doctor_duty t3 ON t.hospital_doctor_duty_id = t3.hospital_id
		LEFT JOIN hospital_receive_log t4 ON (t.hospital_id=t4.hospital_id AND t.doctor_code=t4.doctor_code)
		WHERE
			t.user_id = #{userId,jdbcType=VARCHAR}
	</select>
</mapper>
