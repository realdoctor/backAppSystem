<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kanglian.healthcare.back.dal.dao.AskQuestionAnswerDao">
	<select id="getListByUserId" resultMap="BaseResultMap" parameterType="java.lang.Integer">
		select
		<include refid="columns"/>
		from ask_question_answer t
		where t.user_id = #{userId,jdbcType=INTEGER}
		order by t.add_time desc
	</select>
	
	<select id="getListByMessageId" resultMap="BaseResultMap" parameterType="java.lang.String">
		SELECT
			t.id,
			t.message_id,
			t.user_id,
			t.to_user,
			t.question,
			t.answer,
			t.status,
			t.add_time,
			t.last_update_dtime,
			u1.real_name AS patientRealName,
			u2.real_name AS doctorRealName,
			t2.src,
			t2.remark
		FROM
			ask_question_answer t
		LEFT JOIN upload_patient t2 ON t2.question_id=t.id
		LEFT JOIN user u1 ON u1.user_id=t.user_id
		LEFT JOIN user u2 ON u2.user_id=t.to_user
		WHERE message_id=#{messageId,jdbcType=VARCHAR}
		ORDER BY t.add_time desc
	</select>
</mapper>
